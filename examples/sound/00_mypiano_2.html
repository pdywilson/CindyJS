<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Keyboard Piano</title>
    <style type="text/css">
        * {
            margin: 0px;
            padding: 0px;
        }

        #CSConsole {
            background-color: #FAFAFA;
            border-top: 1px solid #333333;
            bottom: 0px;
            height: 200px;
            overflow-y: scroll;
            position: fixed;
            width: 100%;
        }
    </style>
    <link rel="stylesheet" href="http://cinderella.de/CindyJS/latest/CindyJS.css">
<script type="text/javascript" src="../../build/js/Cindy.js"></script>

<script id="csdraw" type="text/x-cindyscript">
x=C.x;
if(x<0,x=0);
if(x>1,x=1);
C.xy=(x,1.5);

harms = [1,1,1,1,1,1,1,1,1,1,1]*C.x;

ls=alllines();
apply(ls,l,l.selected=false);
sitar=Text1.pressed;
played=false;


if(German.pressed,

  keys=["A","W","S","E","D","F","T","G","Z","H","U","J","K","O","L","P","º","Þ","Ý","Ü",
        "Y","X","C","V","B","N","M","¼","¾","¿";];
        drawtext((-0.9,0.4),"W E    T Z U   O P",size->41);
        drawtext((-1,0),"A S D F G H J K L Ö Ä",size->40);,

  keys=["A","W","S","E","D","F","T","G","Y","H","U","J","K","O","L","P","º","Þ","Ý","Ü",
        "Z","X","C","V","B","N","M","¼","¾","¿";];//23+10
        drawtext((-0.9,0.4),"W E    T Y U   O P",size->41);
        drawtext((-1,0),"A S D F G H J K L Ö Ä",size->40);
      );


;
</script>

<script id="cskeydown" type="text/x-cindyscript">

repeat(30, i,
  if(key() == keys_i & keyson_i == 0,
    play(i);
    keyson_i=1;
  )
);

</script>


<script id="cskeyup" type="text/x-cindyscript">
repeat(30, i,
  if(key()==keys_i,
    playdamp(i);
    keyson_i=0;
  )
);

</script>
<script id="csmousedown" type="text/x-cindyscript">

;
</script>
<script id="csmousedrag" type="text/x-cindyscript">


;
</script>
<script id="csmouseup" type="text/x-cindyscript">

</script>
<script id="csinit" type="text/x-cindyscript">

notes=(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);
keys=["A","W","S","E","D","F","T","G","Y","H","U","J","K","O","L","P","º","Þ","Ý","Ü",
      "Z","X","C","V","B","N","M","¼","¾","¿";];//23+10
keyson = (0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);

sitar=Text1.pressed;
if(sitar,
  harms=[1,1,1,1,1,1,1,1,1,1,1]*0.1,
  harms=[1]);


f(n) := 2^((n-49)/12)*440;

num = 20;
grundton = 51; //52=C but i starts at 1
repeat(num,i,
    notes_i=f(i+grundton));
  ;
  //grundtoene unten links
  notes_(num+1)=f(grundton-11);
  notes_(num+2)=f(grundton-9);
  notes_(num+3)=f(grundton-7);
  notes_(num+4)=f(grundton-6);
  notes_(num+5)=f(grundton-4);
  notes_(num+6)=f(grundton-2);
  notes_(num+7)=f(grundton);
  notes_(num+8)=f(grundton+1);
  //special:
  notes_(num+9)=f(grundton+21);
  notes_(num+10)=f(grundton+22);

partials = [1,1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8];

am=0.4;
play(i):=playsin(notes_i,amp->100*am/notes_i, damp->1, duration->4, harmonics->harms, partials->partials, line->i);
playdamp(i):=playsin(amp->100*am/notes_i, damp->1, duration->4, harmonics->harms, partials->harms, line->i, restart->false);


//TODO:draw piano

;
</script>

    <script type="text/javascript">
createCindy({
  scripts: "cs*",
  defaultAppearance: {
    dimDependent: 0.7,
    fontFamily: "sans-serif",
    lineSize: 1,
    pointSize: 5.0,
    textsize: 12.0
  },
  angleUnit: "°",
  geometry: [
    {name: "Text1", type: "ToggleButton", pos: [-0.4,1], color: [0.0, 0.0, 0.0], fillcolor: [1.0, 1.0, 1.0], fillalpha: 1.0, alpha: 0.8999999761581421, text: "Click!"},
    {name: "German", type: "ToggleButton", pos: [-1.8,-1.8], color: [0.0, 0.0, 0.0], fillcolor: [1.0, 1.0, 1.0], fillalpha: 1.0, alpha: 0.8999999761581421, text: "German Keyboard!"},
    {name:"A", type:"Free", pos:[0,1.5],color:[0,0,0],pinned:true,size:3},
    {name:"B", type:"Free", pos:[1,1.5],color:[0,0,0],size:3},
    {name:"a", type:"Segment", args:["A","B"],color:[0,0,0],size:1},
    {name:"C", type:"Free", pos:[0.5,1.5],color:[1,1,0],size:5}
  ],
  autoplay: true,
  ports: [{
    id: "CSCanvas",
    width: 577,
    height: 546,
    transform: [{visibleRect: [-2,2,2,-2]}],
  }],
  cinderella: {build: 1847, version: [2, 9, 1847]}
});
    </script>
</head>
<body>
    <div id="CSCanvas"></div>

</body>
</html>
